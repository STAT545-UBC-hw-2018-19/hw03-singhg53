---
title: "hw03.Rmd"
author: "Gurjot Singh"
date: "01/10/2018"
output: github_document
---

# Homework 3 - singhg53

Hello and welcome to my Rmd file for homework #3. Today we will be exploring the `tidyverse` package, specifically `ggplot2` and `dplyr` packages using the `gapminder` dataset.

First lets load the dataset, `gapminder` and the `tidyverse` package which has `dplyr` the data manipulation tool and `ggplot2` the data visualization tool.


```{r}
suppressPackageStartupMessages(library(tidyverse))
suppressPackageStartupMessages(library(gapminder))
```
Now let's analyze some data.

# Task 1
#### For our first task we will: **Get the maximum and minimum of GDP per capita for all continents.**

First lets assign the minimum and maximum GDP per capita, grouped by continents, to variable `GDPcont`.
For ease of understanding I will be defining some functions as we go along. The `group_by()` is **used to take an existing tbl and converts it into a grouped tbl where operations are performed.**

```{r}
GDPcont <- gapminder %>%
  group_by(continent) %>% #organized by continent
  summarize(min = min(gdpPercap), max = max(gdpPercap)) #defining the min and max for gdpPercap

knitr::kable(GDPcont)
```

The `knitr::kable` function is useful to make our tables more asethetically pleasing.

Now let's create some plots using the `ggplot2` data visualization tool. For the first plot we will look at the minimum GDP per capita for each continent.

```{r}
ggplot(GDPcont, aes(continent, min)) + 
  geom_bar(stat = "identity", color = "red", fill = "red") + 
  scale_y_log10() + #this applies a log scale on the y-axis
  ggtitle("Minimum GDP per Capita for Each Continent") + #this adds a title to the graph
  ylab("Minimum GDP per Capita") + #this labels the y-axis
  xlab("Continent") #this labels the x-axis
```

We can do the same for the maximum GDP per capita values for each continent:

```{r}
ggplot(GDPcont, aes(continent, max)) + 
  geom_bar(stat = "identity", color = "green", fill = "green") + 
  ggtitle("Maximum GDP per Capita for Each Continent") + 
  ylab("Maximum GDP per Capita") +
  xlab("Continent")
```


# Task 2
#### Look at the spread of GDP per capita within the continents.

Violin plots are great to visualize the spread of the data. Below we have used continent as the x-variable, whereas we used gdpPercap, as the y-variable. The alpha value is specificed to 0.1 and can tell us visually the density of each point. 

```{r}
ggplot(gapminder, aes(continent, gdpPercap, fill=continent)) + 
  scale_y_log10() +
  geom_violin() +
  geom_boxplot() +
  geom_jitter(alpha=0.1) +
  labs(title="Violin Plot of GDP per Capita for Each Continent") +
  ylab("GDP per Capita") +
  xlab("Continent")
```

# Task 3
#### Compute a trimmed mean of life expectancy for different years. Or a weighted mean, weighting by population.

For this task we need to use the `trim` function. `trim` is essentially used to trim the data to a certain specificed value. For example if we set the trim to 0.16, it will cut off 16% of the data from the bootom and top of the data. Interestingly, this would mean that it would represent one standard if the trim is set to 0.16.

Below we created a new dataset called `trimmed_mean`. The data was piped from `gapminder`, grouped by the year, and summarized into two other variables Untrimmed Mean LifeExp (regular mean for each continent) and TrimmedMeanLifExp.

```{r}
trimmed_mean <- gapminder %>% group_by(year) %>% summarize("Untrimmed Mean LifeExp" = mean(lifeExp), TrimmedMeanLifExp = mean(lifeExp,trim = 0.16)) %>% arrange(year)

trimmed_mean
```

We will now go ahead and plot the trimmed mean lifeExp for each year.

```{r}
ggplot(trimmed_mean, aes(year, TrimmedMeanLifExp)) +
  geom_point(colour = "blue") +
  geom_smooth(colour = "light blue")
```

Another intersting function we could use is `weighted.mean()`. Weighted mean is a kind of average, however, some variables can contribute more weight to specific numbers. In this example we use the weighted mean of lifeExp and population together.

```{r}
weightedmean_lifeExp <- gapminder %>% group_by(year) %>% summarize("Mean" = mean(lifeExp), weightedmean = weighted.mean(lifeExp, pop))

weightedmean_lifeExp
```

The trimmed mean graph wasn't that useful because we weren't able to combine different data. Below we combine the mean, trimmed mean lifeExp (where trim = 0.16), and the weighted average together.

```{r}
combineddata <- gapminder %>% group_by(year) %>% summarize( Mean = mean(lifeExp), weightedmean = weighted.mean(lifeExp, pop), TrimmedMeanLifExp = mean(lifeExp,trim = 0.16))

combineddata
```

Now since we have our dataset, `combineddata`, we could go ahead and plot it below.

```{r}
combineddata %>% 
  ggplot(aes(year)) +
  geom_line(aes(y = weightedmean, colour = "Weighted Mean")) +
  geom_line(aes(y = TrimmedMeanLifExp, colour = "Trimmed Mean LifExp")) +
  geom_line(aes(y = Mean, colour = "Mean")) +
  ylab("Life Expectancy") +
  xlab("Year") +
  ggtitle("Mean LifeExp, Trimmed Mean LifeExp, and Weighted Mean LifeExp vs. Year")
```

It is interesting to note that the weighted lifeExp goes down from both the trimmed mean and the normal mean of the data. This indicates that the weighted average of the population went down as a function of the lifeExp.

# Task 4

#### How is life expectancy changing over time on different continents?

```{r}
  ggplot(gapminder, aes(x = year, y = lifeExp, colour = continent)) +
  geom_point(alpha=0.3) +
  geom_smooth() +
  ylab("Life Expectancy") +
  xlab("Year") +
  ggtitle("Life Expectancy Changing Over Time on Different Continents")
```

# Task 5

```{r}
combineddata2 <- gapminder %>% group_by(continent) %>% summarize(Mean = mean(lifeExp), weightedmean = weighted.mean(lifeExp, pop), TrimmedMeanLifExp = mean(lifeExp,trim = 0.125), medianlifeExp= median(lifeExp))

combineddata2
```


```{r}
ggplot(combineddata2, aes(continent)) +
  geom_jitter(aes(y = weightedmean, colour = "Weighted Mean")) +
  geom_jitter(aes(y = TrimmedMeanLifExp, colour = "Trimmed Mean LifExp")) +
  geom_jitter(aes(y = Mean, colour = "Mean")) +
  geom_jitter(aes(y = medianlifeExp, colour = "Median LifeExp")) +
  ylab("Life Expectancy") +
  xlab("Year") +
  ggtitle("Weighted Mean, Trimmed Mean, Mean, and Median Life Expectancy")
```
